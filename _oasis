OASISFormat:  0.1
OCamlVersion: >= 3.10.2
Name:         oasis
Version:      0.1.0
LicenseFile:  COPYING.txt
License:      LGPL-2.1 with OCaml linking exception
BuildType:    ocamlbuild (0.1.0)
Authors:      Sylvain Le Gall
Copyrights:   (C) 2008-2010 OCamlCore SARL
Homepage:     http://oasis.forge.ocamlcore.org/
Plugins:      DevFiles (0.1.0), StdFiles (0.1.0), META (0.1.0)
FilesAB:      src/oasis/OASISConf.ml.ab

Synopsis: Architecture for building OCaml libraries and applications
Description:
  OASIS generates a full configure, build and install system for your
  application. It starts with a simple `_oasis` file at the toplevel of your
  project and creates everything required.
  .
  It uses external tools like OCamlbuild and it can be considered as the glue
  between various subsystems that do the job. It should support the following
  tools: 
  - OCamlbuild
  - OMake (todo)
  - OCamlMakefile (todo),
  - ocaml-autoconf (todo)
  .
  It also features a do-it-yourself command line invocation and an internal 
  configure/install scheme. Libraries are managed through findlib. It has been
  tested on GNU Linux and Windows.
  .
  It also allows to have standard entry points and description. It helps to 
  integrates your libraries and software with third parties tools like GODI.

Flag libraries
  Description: Install oasis and base libraries, for plugins development

Flag gettext
  Description: Use ocaml-gettext for i18n
  Default: false

BuildTools: make
if flag(gettext) 
  PostBuildCommand: $make -C po all
  PostCleanCommand: $make -C po clean
  PostInstallCommand:   $make -C po install PODIR=$prefix/share/locale
  PostUninstallCommand: $make -C po install PODIR=$prefix/share/locale

Executable ocamlmod
  Path:   src/tools
  MainIs: ocamlmod.ml
  BuildDepends: fileutils, str
  Install: false
  
Library oasis
  Path: src/oasis
  Modules: FormatExt,
           OASISGettext,
           OASISMessage,
           ODNFunc,
           PropList,
           OASIS,
           OASISBuildSection,
           OASISDocument,
           OASISExecutable,
           OASISExpr,
           OASISFlag,
           OASISHelp,
           OASISLibrary,
           OASISPackage,
           OASISPlugin,
           OASISSourceRepository,
           OASISTest,
           OASISTypes,
           OASISUnixPath,
           OASISUtils,
           OASISValues,
           OASISVersion,
           OASISLicense
  InternalModules: OASISVersion_lexer,
                   OASISVersion_parser,
                   OASISSection,
                   OASISSchema,
                   OASISConf,
                   OASISAst,
                   OASISCheck,
                   OASISRecDescParser,
                   OASISCustom,
                   OASISQuickstart,
                   OASISData
  CompiledObject: byte
  BuildDepends: fileutils, unix, str, extlib, findlib, odn, ocamlgraph
  BuildTools: ocamlmod, ocamlyacc, ocamllex, ocamlify
  XMETADescription: _oasis file functions
  Install$: flag(libraries)

Library base
  Path: src/base
  Modules: BaseArgExt,
           BaseBuilt,
           BaseCheck,
           BaseCustom,
           BaseData,
           BaseDev,
           BaseDoc,
           BaseEnvLight,
           BaseEnv,
           BaseExec,
           BaseFileAB,
           BaseFileGenerate,
           BaseFilePath,
           BaseFileUtil,
           BaseGenerate,
           BaseLog,
           BaseOCamlcConfig,
           BaseSetup,
           BaseStandardVar,
           BaseTest,
           BaseDynVar
  CompiledObject: byte
  BuildDepends: oasis
  BuildTools: ocamlmod, ocamlify
  FindlibParent: oasis
  XMETADescription: setup.ml modules for OASIS
  Install$: flag(libraries)

Library "builtin-plugins"
  Path: src
  Modules: OASISBuiltinPlugins
  InternalModules: plugins/none/NonePlugin,
                   plugins/none/NoneData,
                   plugins/internal/InternalConfigurePlugin, 
                   plugins/internal/InternalInstallPlugin,
                   plugins/internal/InternalData,
                   plugins/internal/InternalId,
                   plugins/ocamlbuild/OCamlbuildPlugin,
                   plugins/ocamlbuild/OCamlbuildDocPlugin,
                   plugins/ocamlbuild/OCamlbuildData,
                   plugins/ocamlbuild/OCamlbuildCommon,
                   plugins/ocamlbuild/OCamlbuildId,
                   plugins/ocamlbuild/MyOCamlbuildBase,
                   plugins/ocamlbuild/MyOCamlbuildFindlib,
                   plugins/custom/CustomPlugin,
                   plugins/custom/CustomData,
                   plugins/extra/META/METAPlugin,
                   plugins/extra/META/METAData,
                   plugins/extra/devfiles/DevFilesPlugin,
                   plugins/extra/devfiles/DevFilesData,
                   plugins/extra/stdfiles/StdFilesPlugin,
                   plugins/extra/stdfiles/StdFilesData
  Install: false
  CompiledObject: byte
  BuildDepends: oasis, oasis.base
  XOCamlbuildAutoDoc: false
  XMETAEnable: false

Executable OASIS
  Path:   src
  MainIs: OASISMain.ml
  BuildDepends: oasis, oasis.base, builtin-plugins

Executable test
  Path: test
  MainIs: test.ml
  Install: false
  CompiledObject: byte
  BuildDepends: oUnit, oasis, oasis.base, builtin-plugins

Test main
  Type: custom (0.1.0)
  Command: $test
  WorkingDirectory: test 
  TestTools: OASIS, test

Document manual
  Type: custom (0.1.0)
  Title: OASIS User Manual
  if flag(gettext) 
    XCustom: $OASIS --gettext-language C -documentation > doc/MANUAL.mkd
  else
    XCustom: $OASIS -documentation > doc/MANUAL.mkd
  XCustomClean: $rm doc/MANUAL.mkd
  DataFiles: doc/MANUAL.mkd

